<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qat.lang.qrout &mdash; myQLM documentation  documentation</title>
      <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" type="text/css" />
    <link rel="shortcut icon" href="../../../static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../../../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../static/documentation_options.js"></script>
        <script src="../../../static/jquery.js"></script>
        <script src="../../../static/underscore.js"></script>
        <script src="../../../static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../static/doctools.js"></script>
        <script src="../../../static/sphinx_highlight.js"></script>
        <script src="../../../static/design-tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="qat.lang.AbstractGate" href="abstractgate.html" />
    <link rel="prev" title="qat.lang.qfunc" href="qfunc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> myQLM documentation
            <img src="../../../static/myqlm-doc-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                myQLM-1.9.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../01_getting_started.html">Getting started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../02_user_guide.html">User guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../04_api_reference.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../module_qat.html">qat</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../module_comm.html">qat.comm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_core.html">qat.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_devices.html">qat.devices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_fermion.html">qat.fermion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_generators.html">qat.generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_hardware.html">qat.hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../%3Amyqlm%3Amodule_interop.html">qat.interop</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../module_lang.html">qat.lang</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="program.html">qat.lang.Program</a></li>
<li class="toctree-l4"><a class="reference internal" href="qfunc.html">qat.lang.qfunc</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">qat.lang.qrout</a></li>
<li class="toctree-l4"><a class="reference internal" href="abstractgate.html">qat.lang.AbstractGate</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_gate.html">qat.lang.build_gate</a></li>
<li class="toctree-l4"><a class="reference internal" href="gate.html">qat.lang.AQASM.gates.Gate</a></li>
<li class="toctree-l4"><a class="reference internal" href="paramgate.html">qat.lang.AQASM.gates.ParamGate</a></li>
<li class="toctree-l4"><a class="reference internal" href="qroutine.html">qat.lang.QRoutine</a></li>
<li class="toctree-l4"><a class="reference internal" href="qbool.html">qat.lang.AQASM.qbool.QBool</a></li>
<li class="toctree-l4"><a class="reference internal" href="qboolarray.html">qat.lang.AQASM.qbool.QBoolArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="qclause.html">qat.lang.AQASM.qbool.QClause</a></li>
<li class="toctree-l4"><a class="reference internal" href="qarithexp.html">qat.lang.AQASM.qint.QArithExp</a></li>
<li class="toctree-l4"><a class="reference internal" href="qcompexp.html">qat.lang.AQASM.qint.QCompExp</a></li>
<li class="toctree-l4"><a class="reference internal" href="qint.html">qat.lang.AQASM.qint.QInt</a></li>
<li class="toctree-l4"><a class="reference internal" href="boolformula.html">qat.lang.AQASM.bits.BoolFormula</a></li>
<li class="toctree-l4"><a class="reference internal" href="cbit.html">qat.lang.AQASM.bits.Cbit</a></li>
<li class="toctree-l4"><a class="reference internal" href="cregister.html">qat.lang.AQASM.bits.CRegister</a></li>
<li class="toctree-l4"><a class="reference internal" href="qbit.html">qat.lang.AQASM.bits.Qbit</a></li>
<li class="toctree-l4"><a class="reference internal" href="qregister.html">qat.lang.AQASM.bits.QRegister</a></li>
<li class="toctree-l4"><a class="reference internal" href="generate_gate_set.html">qat.lang.AQASM.misc.generate_gate_set</a></li>
<li class="toctree-l4"><a class="reference internal" href="linker.html">qat.lang.linking.Linker</a></li>
<li class="toctree-l4"><a class="reference internal" href="module_arithmetic.html">qat.lang.AQASM.arithmetic</a></li>
<li class="toctree-l4"><a class="reference internal" href="module_classarith.html">qat.lang.AQASM.classarith</a></li>
<li class="toctree-l4"><a class="reference internal" href="module_qftarith.html">qat.lang.AQASM.qftarith</a></li>
<li class="toctree-l4"><a class="reference internal" href="kptree.html">qat.lang.models.KPTree</a></li>
<li class="toctree-l4"><a class="reference internal" href="amplification_step.html">qat.lang.algorithms.amplification_step</a></li>
<li class="toctree-l4"><a class="reference internal" href="phase_estimation.html">qat.lang.algorithms.phase_estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="quantum_counting.html">qat.lang.algorithms.quantum_counting</a></li>
<li class="toctree-l4"><a class="reference internal" href="grover_diffusion.html">qat.lang.algorithms.amplification.grover_diffusion</a></li>
<li class="toctree-l4"><a class="reference internal" href="householder.html">qat.lang.algorithms.amplification.householder</a></li>
<li class="toctree-l4"><a class="reference internal" href="uniform_distribution.html">qat.lang.algorithms.amplification.uniform_distribution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../module_opt.html">qat.opt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_plugins.html">qat.plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../%3Amyqlm%3Amodule_pylinalg.html">qat.pylinalg</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_qpus.html">qat.qpus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../module_quops.html">qat.quops</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../05_demos.html">Demos</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../%3Amyqlm%3A06_support.html">Contributing to myQLM</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../07_release_notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">myQLM documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../04_api_reference.html">API reference</a> &raquo;</li>
          <li><a href="../../module_qat.html">qat</a> &raquo;</li>
          <li><a href="../module_lang.html">qat.lang</a> &raquo;</li>
      <li>qat.lang.qrout</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qat-lang-qrout">
<h1>qat.lang.qrout<a class="headerlink" href="#qat-lang-qrout" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="qat.lang.qrout">
<span class="sig-prename descclassname"><span class="pre">qat.lang.</span></span><span class="sig-name descname"><span class="pre">qrout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unroll</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#qat.lang.qrout" title="Permalink to this definition"></a></dt>
<dd><p>A decorator that turns a function into a QRoutine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unroll</strong> (<em>optional</em><em>, </em><em>bool</em>) – If set to True, the decorator will unroll statically the function, generating
a QRoutine object. If set to False, the function will be called everytime the wrapped function is called.
If set to None (or not set), the decorator will attempt to unroll and still wrap the function if the unrolling fails.</p>
</dd>
</dl>
<p>Inside the decorated function, qbits can be referred to via their indices (hence integers).
The intended usage is the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qat.lang</span> <span class="kn">import</span> <span class="n">qrout</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">CNOT</span>

<span class="nd">@qrout</span>
<span class="k">def</span> <span class="nf">bell_state</span><span class="p">():</span>
    <span class="c1"># Inside the function, qbits can be referred to directly by their indices</span>
    <span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">CNOT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># the return value will be ignore, no need to have one</span>

<span class="c1"># The resulting object can be called as a function:</span>
<span class="n">bell_state</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">bell_state</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="o">.</span><span class="n">state</span><span class="p">,</span> <span class="n">sample</span><span class="o">.</span><span class="n">probability</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> ┌─┐   
─┤H├─●─
 └─┘ │ 
     │ 
    ┌┴┐
────┤X├
    └─┘
       

|00&gt; 0.4999999999999999
|11&gt; 0.4999999999999999
</pre></div>
</div>
<p>Passing simple arguments:</p>
<blockquote>
<div><p>The decorated function can take parameters.
The decorator assumes that any parameter is a floating point number. It will replace it by some abstract variable
with a similar name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qat.lang</span> <span class="kn">import</span> <span class="n">qrout</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">RZ</span>

<span class="nd">@qrout</span>
<span class="k">def</span> <span class="nf">h_rz</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">RZ</span><span class="p">(</span><span class="n">theta</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># The resulting object already contains the unrolled circuit</span>
<span class="n">h_rz</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># calling the decorated function instantiates the angles to their values</span>
<span class="n">h_rz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> ┌─┐        
─┤H├────────
 └─┘        
            
 ┌─────────┐
─┤RZ[theta]├
 └─────────┘
            

 ┌─┐      
─┤H├──────
 └─┘      
          
 ┌───────┐
─┤RZ[π/2]├
 └───────┘
          

</pre></div>
</div>
</div></blockquote>
<p>Passing arrays of angles:</p>
<blockquote>
<div><p>It is also possible to decorate functions that take arrays of floating point values as input.
For the decorator to be able to replace those arrays by variables, it needs to know the dimension of the arrays.
These dimensions are passed as keyword arguments to the decorator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When such a shape is specified the argument will be replaced by a numpy array of variables
with a matching shape. It should thus be manipulated as a numpy array (see code below).</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qat.lang</span> <span class="kn">import</span> <span class="n">qrout</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RZ</span>

<span class="nd">@qrout</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">rx_rz</span><span class="p">(</span><span class="n">angles</span><span class="p">):</span>
    <span class="n">RX</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">RZ</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">])(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">rx_rz</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rx_rz</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nd">@qrout</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">custom</span><span class="p">(</span><span class="n">angles</span><span class="p">):</span>
    <span class="c1"># angles is a numpy array of shape (2, 3, 4) containing Variable objects</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="n">RX</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">])(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> ┌────────────┐
─┤RX[angles_0]├
 └────────────┘
               
 ┌────────────┐
─┤RZ[angles_1]├
 └────────────┘
               

 ┌───────┐
─┤RX[π/2]├
 └───────┘
          
 ┌───────┐
─┤RZ[π/4]├
 └───────┘
          

</pre></div>
</div>
</div></blockquote>
<p>Blocking the unroll:</p>
<blockquote>
<div><p>In some cases, one might want to avoir the static unrolling of the function/circuit.
This unrolling can be blocked using the <cite>unroll</cite> keyword argument:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qat.lang</span> <span class="kn">import</span> <span class="n">qrout</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RZ</span>

<span class="nd">@qrout</span><span class="p">(</span><span class="n">unroll</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">rx_rz</span><span class="p">(</span><span class="n">angles</span><span class="p">):</span>
    <span class="n">RX</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="mi">0</span><span class="p">])(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">RZ</span><span class="p">(</span><span class="n">angles</span><span class="p">[</span><span class="mi">1</span><span class="p">])(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># This line would fail, rx_rz does not contain any circuit yet</span>
<span class="c1"># rx_rz.display(batchmode=True)</span>
<span class="n">rx_rz</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> ┌───────┐
─┤RX[π/2]├
 └───────┘
          
 ┌───────┐
─┤RZ[π/4]├
 └───────┘
          

</pre></div>
</div>
<p>By default, the decorator will attempt to unroll the function. If the unrolling fails, it
will still decorate without unrolling.</p>
</div></blockquote>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qfunc.html" class="btn btn-neutral float-left" title="qat.lang.qfunc" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="abstractgate.html" class="btn btn-neutral float-right" title="qat.lang.AbstractGate" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Eviden 2016-2023.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>